<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Одоо гарч буй кино</title>
        <meta http-equiv='X-UA-Compatible' content='IE=edge'>
        <meta name='viewport' content='width=device-width, initial-scale=1'>
        <meta name="description" content="Одоо гарч буй кинонууд, дэлгэцнээ гарч буй кино, кино үзэх">
        <link rel="stylesheet" href="css/nowplaying.css">
        <link rel="stylesheet" href="css/style.css"/>
    </head>
    <body>
        <header>
            <nav>
                <address>
                    <ul id="address_icon">
                        <li><a href="https://www.facebook.com/PrimeCineplexMongolia"><img src="Images/header_fb_icon.png" alt="facebook icon"></a></li>
                        <li><a href="https://www.instagram.com/primecineplex_mongolia/"><img src="Images/header_ig_icon.png"  alt="instagram icon"></a></li>
                        <li><a href="https://www.youtube.com/@primecineplexmongolia3406"><img src="Images/header_yt_icon.png"  alt="youtube icon"></a></li>
                        <li><a href="mailto:info@primecineplex.mn"><img src="Images/footer_mail-icon.png" alt="mail icon"></a></li>
                    </ul>
                </address>
            </nav>
            <nav>
                <a href="index.html"><img src="Images/logo.jpg" id="logo" alt="primeLogo"></a>
                <ul id="menu">
                    <li><a href="js_now.html">КИНО</a></li>
                    <li><a href="aboutus.html">ЗӨВХӨН МАНАЙД</a></li>
                    <li><a href="aboutus.html">ҮЙЛЧИЛГЭЭ</a></li>
                    <li><a href="aboutus.html">БИДНИЙ ТУХАЙ</a></li>
                    <li><a id="login" href="login.html">НЭВТРЭХ</a></li>
                </ul>
            </nav>
        </header>
        <nav id="category-links">
            <a href="?category=Animation" id="animation-link" data-category="Animation">Animation</a>
            <a href="?category=Horror" id="horror-link" data-category="Horror">Horror</a>
            <a href="?category=Adventure" id="adventure-link" data-category="Adventure">Adventure</a>
            <a href="?category=Action" id="action-link" data-category="Action">Action</a>
        </nav>
        <main id="app">
        </main>
        <footer>
            <div id="address_info">
                 <address>
                 <ul>
                     <li>
                         <img src="Images/footer_location-icon.png" alt="location icon">
                         <p>Монгол улс, Улаанбаатар хот, <br>
                             Хан-Уул дүүрэг 11-р хороо, <br>
                             Дүнжингаравын гудамж, <br>
                             Зайсан Хилл Цогцолбор, 1-р давхар</p>
                     </li>
                     <li>
                         <img src="Images/footer_mail-icon.png" alt="mail icon">
                         <a href="mailto:info@primecineplex.mn">@primecineplex.mn</a>
                     </li>
                     <li>
                         <img src="Images/footer_phone-icon.png"  alt="phone icon">
                         <a href="tel:+976-7510-0000">+976-7510-0000</a>
                     </li>
                 </ul>
                 </address>
            </div>
            <div id="map">
                <div class="location">
                    <p>Зайсан Хилл Комплекс</p>
                    <p><a href="https://www.google.com/maps"><img src="Images/footer_googlemap.png" alt="google map photo"></a></p>
                </div>
                <div class="location">
                    <p>Энканто товер</p>
                    <p><a href="https://www.google.com/maps"><img src="Images/footer_googlemap.png" alt="google map photo"></a></p>
                </div>
                <div class="location">
                    <p>Ботаник центер</p>
                    <p><a href="https://www.google.com/maps"><img src="Images/footer_googlemap.png" alt="google map photo"></a></p>
                </div>
            </div>    
         </footer>
         <script>
            class Product {
                constructor(product) {
                    this.id = product.id;
                    this.category = product.category;
                    this.name = product.name;
                    this.img = product.img;
                    this.imdb = product.imdb;
                    this.rtr = product.rtr;
                }
                Render() {
                    return `
                    <article>
                        <a href="movie.html?id=${this.id}" class="movie_poster">
                            <img src="${this.img}" alt="${this.name} poster">${this.name}
                        </a>
                        <div class="rating">
                            <a href="https://www.imdb.com/title/${this.id}/">
                                <img src="Images/imdb_icon.png" alt="imdb rating">${this.imdb}
                            </a>
                            <a href="https://www.rottentomatoes.com/m/${this.name.toLowerCase().replace(/\s/g, '_')}">
                                <img src="Images/rotten_tomatos_icon.png" alt="rotten tomato rating">${this.rtr}
                            </a>
                        </div>
                    </article>`;
                }
            }
            class movie{
                constructor(){

                }
                List(){
                    const mov = [
                                    {
                                        id:1,
                                        category:"Animation",
                                        name: "Suzume",
                                        img: "Images/nowplaying_poster1.png",
                                        imdb: 7.7,
                                        rtr: "96%",
                                    },
                                    {
                                        id:2,
                                        category:"Animation",
                                        name: "Elemental",
                                        img: "Images/nowplaying_poster2.png",
                                        imdb: "7.0",
                                        rtr: "74%",
                                    },
                                    {
                                        id:3,
                                        category:"Horror",
                                        name: "The NUN",
                                        img: "Images/nowplaying_poster3.png",
                                        imdb: 5.8,
                                        rtr: "52%",
                                    },
                                    {
                                        id:4,
                                        category:"Adventure",
                                        name: "Будилаан",
                                        img: "Images/nowplaying_poster4.png",
                                        imdb: "NR",
                                        rtr: "NR",
                                    },
                                    {
                                        id:5,
                                        category:"Action",
                                        name: "The Creator",
                                        img: "Images/comingsoon_poster1.png",
                                        imdb: 7.2,
                                        rtr: "67%",
                                    },
                                    {
                                        id:6,
                                        category:"Animation",
                                        name: "Paw Patrol",
                                        img: "Images/comingsoon_poster2.png",
                                        imdb: 6.1,
                                        rtr: "84%",
                                    },
                                    {
                                        id:7,
                                        category:"Horror",
                                        name: "Cobweb",
                                        img: "Images/comingsoon_poster3.png",
                                        imdb: 5.9,
                                        rtr: "59%",
                                    },
                                    {
                                        id:8,
                                        category:"Horror",
                                        name: "Saw X",
                                        img: "Images/comingsoon_poster4.png",
                                        imdb: 7.2,
                                        rtr: "83%",
                                    },
                                    {
                                        id:9,
                                        category:"Horror",
                                        name: "The Exorcist",
                                        img: "Images/comingsoon_poster5.png",
                                        imdb: 7.1,
                                        rtr: "96%",
                                    },
                    ]; 
                    const p = mov;
                        let data = `
                        <h2 style="color: var(--color-white);
                        padding: 2rem;
                        margin-bottom: 4rem;
                        ">МАНАЙ ДЭЛГЭЦНЭЭ</h2>
                        <section>`;
                    for( const product of p){
                        const prod=new Product(product);
                        data += prod.Render();
                    }
                    data+="</section>";
                    document.getElementById("app").insertAdjacentHTML("beforeend", data);
                }
            }
            class MovieItem {
            constructor(movie) {
                this.id = movie.id;
                this.category = movie.category;
                this.name = movie.name;
                this.img = movie.img;
                this.imdb = movie.imdb;
                this.rtr = movie.rtr;
            }
            Render() {
                return `
                <article>
                    <a href="movie.html?id=${this.id}" class="movie_poster">
                        <img src="${this.img}" alt="${this.name} poster">${this.name}
                    </a>
                    <div class="rating">
                        <a href="https://www.imdb.com/title/${this.id}/">
                            <img src="Images/imdb_icon.png" alt="imdb rating">${this.imdb}
                        </a>
                        <a href="https://www.rottentomatoes.com/m/${this.name.toLowerCase().replace(/\s/g, '_')}">
                            <img src="Images/rotten_tomatos_icon.png" alt="rotten tomato rating">${this.rtr}
                        </a>
                    </div>
                </article>`;
            }
        }
        class MovieList {
            constructor() {
                this.movies = [];
            }

            async FetchData() {
                // Implement this function to fetch your movie data
                //const response = await fetch('your_movie_api_url');
                //const data = await response.json();
                //this.movies = data;
                this.movies = [
                                    {
                                        id:1,
                                        category:"Animation",
                                        name: "Suzume",
                                        img: "Images/nowplaying_poster1.png",
                                        imdb: 7.7,
                                        rtr: "96%",
                                    },
                                    {
                                        id:2,
                                        category:"Animation",
                                        name: "Elemental",
                                        img: "Images/nowplaying_poster2.png",
                                        imdb: "7.0",
                                        rtr: "74%",
                                    },
                                    {
                                        id:3,
                                        category:"Horror",
                                        name: "The NUN",
                                        img: "Images/nowplaying_poster3.png",
                                        imdb: 5.8,
                                        rtr: "52%",
                                    },
                                    {
                                        id:4,
                                        category:"Adventure",
                                        name: "Будилаан",
                                        img: "Images/nowplaying_poster4.png",
                                        imdb: "NR",
                                        rtr: "NR",
                                    },
                                    {
                                        id:5,
                                        category:"Action",
                                        name: "The Creator",
                                        img: "Images/comingsoon_poster1.png",
                                        imdb: 7.2,
                                        rtr: "67%",
                                    },
                                    {
                                        id:6,
                                        category:"Animation",
                                        name: "Paw Patrol",
                                        img: "Images/comingsoon_poster2.png",
                                        imdb: 6.1,
                                        rtr: "84%",
                                    },
                                    {
                                        id:7,
                                        category:"Horror",
                                        name: "Cobweb",
                                        img: "Images/comingsoon_poster3.png",
                                        imdb: 5.9,
                                        rtr: "59%",
                                    },
                                    {
                                        id:8,
                                        category:"Horror",
                                        name: "Saw X",
                                        img: "Images/comingsoon_poster4.png",
                                        imdb: 7.2,
                                        rtr: "83%",
                                    },
                                    {
                                        id:9,
                                        category:"Horror",
                                        name: "The Exorcist",
                                        img: "Images/comingsoon_poster5.png",
                                        imdb: 7.1,
                                        rtr: "96%",
                                    },
                ]; 
            }

            FilterByCategory(category) {
                return category ? this.movies.filter(movie => movie.category === category) : this.movies;
            }

            RenderMovies(targetElement, movies) {
                const movieSection = document.querySelector(targetElement);
                movieSection.innerHTML = '';
                movies.forEach(movie => {
                    const article = document.createElement('article');
                    article.innerHTML = new MovieItem(movie).Render();
                    movieSection.appendChild(article);
                });
            }
        }

        document.addEventListener('DOMContentLoaded', async () => {
            const app = new movie();
            app.List(); // Assign the movie list to the global variable

            const movieList = new MovieList();
            await movieList.FetchData();

            const categoryLinks = document.querySelectorAll('#category-links a');
            categoryLinks.forEach(link => {
                link.addEventListener('click', function (event) {
                    event.preventDefault();
                    const selectedCategory = this.getAttribute('data-category');
                    filterAndRenderMovies(selectedCategory);
                });
            });

            // Get the category from the URL and filter movies accordingly
            const categoryFromUrl = getCategoryFromUrl();
            filterAndRenderMovies(categoryFromUrl);

            async function filterAndRenderMovies(category) {
                const filteredMovies = movieList.FilterByCategory(category);
                movieList.RenderMovies('main section', filteredMovies);

                // Add/remove 'active' class for styling
                categoryLinks.forEach(link => {
                    const linkCategory = link.getAttribute('data-category');
                    if (linkCategory === category) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });
            }
            function getCategoryFromUrl() {
                const urlParams = new URLSearchParams(window.location.search);
                return urlParams.get('category');
            }
        });
        </script>
    </body>
</html>                         